<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<!-- namespace: 해당 mapper파일의 고유한 별칭 -->
<mapper namespace="myPageMapper">


	<!-- 회원 정보 수정 후 세션에 변경된 값 반환하기 위한 resultMapper -->
	<resultMap type="Member" id="loginUserResult">
		<result column="USER_NO" property="userNo"/>
		<result column="USER_ID" property="userId"/>
		<result column="USER_PWD" property="userPwd"/>
		<result column="EMAIL" property="email"/>
		<result column="USER_NAME" property="userName"/>
		<result column="NICKNAME" property="nickname"/>
		<result column="BIRTHDAY" property="birthday"/>
		<result column="GENDER" property="gender"/>
		<result column="ADDRESS" property="address"/>
		<result column="PHONE" property="phone"/>
		<result column="LIKE_FISH" property="likeFish"/>
		<result column="TAIL_FISH" property="tailFish"/>
		<result column="AUTHORITY" property="authority"/>
		<result column="ACTIVATED" property="activated"/>
		<result column="USER_LV" property="userLv"/>
		<result column="JOIN_DATE" property="joinDate"/>
		<result column="MEMBER_FILE_NO" property="memberFileNo"/>
	</resultMap>
	
	<!-- 작성한 게시글 resultMapper -->
	<resultMap type="Community" id="writePostResult">
		<result column="board_level" property="boardLevel"/>
		<result column="board_title" property="boardTitle"/>
		<result column="write_date" property="writeDate"/>
		<result column="board_count" property="boardCount"/>
	</resultMap>
	
	<!-- 작성한 문의글 resultMapper -->
	<resultMap type="Inquiry" id="inquiryResult">
		<result column="inquiry_no" property="inquiryNo"/>
		<result column="inquiry_title" property="inquiryTitle"/>
		<result column="inquiry_date" property="inquiryDate"/>
	</resultMap>

	<!-- 회원 정보 수정 -->
	<update id="modifyInfo">
		UPDATE member
		SET nickname = #{nickname},
		    gender = #{gender},
		    phone = #{phone},
		    email = #{email},
		    address = #{address}
		WHERE user_no = #{userNo}
	</update>
	
	<!-- 회원 정보 수정 후 세션에 변경된 값 넣기 -->
	<select id="loginUser" resultMap="loginUserResult">
		SELECT 	USER_NO,
				USER_ID,
				USER_PWD,
				EMAIL,
				USER_NAME,
				NICKNAME,
				BIRTHDAY,
				GENDER,
				ADDRESS,
				PHONE,
				LIKE_FISH,
				TAIL_FISH,
				AUTHORITY,
				ACTIVATED,
				USER_LV,
				JOIN_DATE,
				MEMBER_FILE_NO
		FROM	MEMBER
		WHERE	USER_NO = #{userNo}
		AND		ACTIVATED = 'Y'
	</select>






	<!-- 작성한 게시글 리스트 조회 -->
	<select id="writePostList" resultMap="writePostResult">
		SELECT board_level,
			   board_title,
			   write_date,
			   board_count
		FROM board
		WHERE status = 'Y'
		AND user_no = #{userNo}
		ORDER BY write_date DESC
	</select>
	
	<!-- 작성한 문의글 리스트 조회 -->
	<select id="inquiryList" resultMap="inquiryResult">
		SELECT inquiry_no,
			   inquiry_title,
			   inquiry_date,
			   status
		FROM inquiry
		WHERE status = 'Y'
		AND user_no = #{userNo}
		ORDER BY inquiry_date DESC
	</select>
	




</mapper>